version: 2
models:
  - name: dim_listings_cleansed
    columns:
      - name: listing_id
        tests:
          - unique
          - not_null
        description: The primary key used to identify each listing object on Airbnb.
          This column is crucial for data analysis as it allows for unique
          identification and tracking of individual listings. Data analysts can
          use this column to join and link the listings data with other
          datasets, such as reviews or bookings, to gain insights into specific
          listings' performance, popularity, and customer satisfaction.
          Additionally, this column can be used to aggregate and summarize data
          at the listing level, enabling analysis of trends, patterns, and
          comparisons across different listings.
      - name: host_id
        tests:
          - not_null
          - relationships:
              to: ref('dim_hosts_cleansed')
              field: host_id
        description: The unique identifier for the host of the Airbnb listing. This
          column is useful for analyzing host-related metrics, such as the
          number of listings per host, the average price of listings per host,
          or identifying the most active hosts on the platform. It can also be
          used to join with other tables to gather additional information about
          the hosts, such as their reviews or ratings.
      - name: room_type
        tests:
          - accepted_values:
              values:
                - Entire home/apt
                - Private room
                - Shared room
                - Hotel room
        description: The 'room_type' column represents the type of room available in the
          listing. It provides information about the accommodation options
          offered by the host, such as 'Entire home/apt', 'Private room',
          'Shared room', or 'Hotel room'. This column is useful for analyzing
          the distribution of different room types available on the platform. It
          can be used to understand the preferences of guests and identify
          trends in booking patterns. For example, it can help determine whether
          certain room types are more popular in specific locations or during
          particular seasons. Additionally, this column can be used to segment
          and compare the average prices, minimum nights, and other metrics
          across different room types, enabling data analysts to provide
          insights on the most profitable or in-demand room types for hosts.
      - name: minimum_nights
        tests:
          - positive_value
        description: The minimum number of nights a guest is required to book for this
          listing. This column is useful for analyzing the booking patterns and
          preferences of guests. It can be used to identify popular listings
          that have a higher minimum nights requirement, which may indicate a
          higher demand or longer stays. Additionally, it can be used to
          understand the impact of minimum nights on booking rates and revenue
          for hosts. Data analysts can use this column to identify trends and
          patterns in guest behavior and make recommendations to hosts on
          adjusting their minimum nights requirement to optimize occupancy and
          revenue.
    description: The 'dim_listings_cleansed' dbt model is used to create a cleansed
      version of the 'listings' table. It extracts relevant columns such as
      listing_id, listing_name, room_type, minimum_nights, host_id, price,
      created_at, and updated_at from the raw_listings table. The minimum_nights
      column is transformed to ensure a minimum value of 1. The price column is
      converted from a string format to a decimal format. This model provides a
      clean and standardized view of the listings data, making it easier for
      data analysts to analyze and report on.
